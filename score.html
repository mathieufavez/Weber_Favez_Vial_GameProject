<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="css/styles.css"/>
    <title>Bomberman | Scores</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"/>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>


</head>
    <body>
        <main>
            <h1>Hall of fame</h1>
            <h1>Your score :</h1>
            <h1 id="result"></h1>

            <script>document.getElementById("result").innerHTML = localStorage.getItem("timeScore");</script>

            <label for="name" id="nameLabel">Nom:</label>
            <input type="text" id="name"><br>

            <input type="button" id="addButton" value="Ajouter" onClick="AfficherMasquer();Masquer();AddToJson()">

            <div class="container" id="divacacher" style="display: none">
                <div class="table-responsive">
                    <h1>Scores</h1>
                    <br/>
                    <table class="table table-bordered table-striped" id="employee_table">
                        <tr>
                            <th>Name</th>
                            <th>Score</th>
                        </tr>
                    </table>
                </div>
            </div>


            <a class="bouton" href="menu.html"> Rejouer </a>

        </main>
    </body>
</html>

<script>
    $(document).ready(function(){
        $.getJSON("scores.json", function(data){
            let employee_data = '';
            $.each(data, function(key, value){
                employee_data += '<tr>';
                employee_data += '<td>' + value.name +'</td>';
                employee_data += '<td>' + value.score +'</td>';
                employee_data += '</tr>';
            });
            $('#employee_table').append(employee_data);
        });
    });
</script>

<script type="text/javascript">

    function AfficherMasquer()
    {
        divInfo = document.getElementById('divacacher');

        if (divInfo.style.display == 'none')
            divInfo.style.display = 'block';
        else
            divInfo.style.display = 'none';
    }

    function Masquer()
    {
        buttonInfo = document.getElementById('addButton');
        labelInfo = document.getElementById('nameLabel');
        nameInfo = document.getElementById('name');
        buttonInfo.style.display = 'none';
        labelInfo.style.display = 'none';
        nameInfo.style.display ='none';

    }

    function AddToJson()
    {
        let name = document.getElementById("name").value;
        let score = document.getElementById("result").innerHTML = localStorage.getItem("timeScore");

        var fs = require('fs');
        fs.readFile('scores.json', 'utf-8', function(err, data) {
            if (err) throw err;

            var arrayOfObjects = JSON.parse(data);
            console.log(arrayOfObjects);
            arrayOfObjects.push({
                name: name,
                score: score
            });

            console.log(arrayOfObjects);

            fs.writeFile('scores.json', JSON.stringify(arrayOfObjects), 'utf-8', function(err) {
                if (err) throw err;
                console.log('Done!');
            });
        });
    }
</script>




